kind: pipeline
name: ubuntu

steps:
- name: vppbuild
  image: index.docker.io/snergster/vpp-ubuntu18
  commands:
  - ls -l
  - git pull || true
  - make UNATTENDED=yes install-dep
  - make pkg-deb
  when:
    event:
    - push
    instance:
      exclude:
        - drone.fdiopoc.net
        - 5346a318.ngrok.io
---
kind: pipeline
name: centos

steps:
- name: vppbuild
  image: index.docker.io/snergster/vpp-centos
  commands:
  - ls
  - git pull || true
  - make UNATTENDED=yes verify
  when:
    event:
    - push
    instance:
      exclude:
        - drone.fdiopoc.net
        - 5346a318.ngrok.io
---
kind: pipeline
name: ubuntuarmies

platform:
  os: linux
  arch: arm64

steps:
- name: vppbuild
  image: index.docker.io/snergster/ubuntu18arm
  commands:
  - grep search /etc/resolv.conf || true
  - git pull || true
  - make UNATTENDED=yes verify
  when:
    event:
    - push

